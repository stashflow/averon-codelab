{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/emers/Documents/Averon%20Systems/ACL/lib/supabase/client.ts"],"sourcesContent":["import { createBrowserClient } from '@supabase/ssr'\n\nexport function createClient() {\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n  const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n\n  if (!supabaseUrl || !supabaseKey) {\n    console.error('[v0] Supabase environment variables are not set')\n    console.error('[v0] NEXT_PUBLIC_SUPABASE_URL:', supabaseUrl ? 'SET' : 'MISSING')\n    console.error('[v0] NEXT_PUBLIC_SUPABASE_ANON_KEY:', supabaseKey ? 'SET' : 'MISSING')\n    throw new Error('Supabase is not configured. Please add NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables.')\n  }\n\n  return createBrowserClient(supabaseUrl, supabaseKey)\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;;AAEO,SAAS;IACd,MAAM;IACN,MAAM;IAEN;;IAOA,OAAO,IAAA,iMAAmB,EAAC,aAAa;AAC1C"}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/emers/Documents/Averon%20Systems/ACL/app/protected/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { createClient } from '@/lib/supabase/client'\n\nexport const dynamic = 'force-dynamic'\n\nexport default function ProtectedRoute() {\n  const router = useRouter()\n\n  useEffect(() => {\n    async function checkRoleAndRedirect() {\n      const supabase = createClient()\n\n      try {\n        const {\n          data: { user: authUser },\n          error: userError,\n        } = await supabase.auth.getUser()\n\n        if (userError || !authUser) {\n          router.push('/auth/login')\n          return\n        }\n\n        let profile: { role?: string; school_id?: string | null } | null = null\n        const profileWithSchool = await supabase\n          .from('profiles')\n          .select('role, school_id')\n          .eq('id', authUser.id)\n          .single()\n\n        if (profileWithSchool.error && profileWithSchool.error.message?.toLowerCase().includes('school_id')) {\n          const profileWithoutSchool = await supabase\n            .from('profiles')\n            .select('role')\n            .eq('id', authUser.id)\n            .single()\n\n          profile = profileWithoutSchool.data ? { ...profileWithoutSchool.data, school_id: null } : null\n        } else {\n          profile = profileWithSchool.data\n        }\n\n        const validRoles = new Set(['full_admin', 'district_admin', 'school_admin', 'teacher', 'student'])\n        if (!profile?.role || !validRoles.has(profile.role)) {\n          router.push('/onboarding/role')\n          return\n        }\n\n        if (profile?.role === 'full_admin') {\n          router.push('/admin/panel')\n          return\n        }\n\n        const [{ data: districtAdmin }, { data: schoolAdmin }] = await Promise.all([\n          supabase.from('district_admins').select('id').eq('admin_id', authUser.id).maybeSingle(),\n          supabase.from('school_admins').select('id').eq('admin_id', authUser.id).maybeSingle(),\n        ])\n\n        if (profile?.role === 'district_admin' || districtAdmin) {\n          router.push('/district/admin')\n          return\n        }\n\n        if (profile?.role === 'school_admin' || schoolAdmin) {\n          router.push('/school/admin')\n          return\n        }\n\n        if (profile?.role === 'teacher') {\n          if (!profile.school_id) {\n            router.push('/onboarding/teacher')\n            return\n          }\n          router.push('/protected/teacher')\n          return\n        }\n\n        router.push('/student/dashboard')\n      } catch (err: any) {\n        console.error('[v0] Error checking role:', err)\n        router.push('/auth/login')\n      }\n    }\n\n    checkRoleAndRedirect()\n  }, [router])\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center\">\n      <div className=\"text-center\">\n        <div className=\"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4\" />\n        <p className=\"text-foreground text-base\">Redirecting to your dashboard...</p>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AACA;AAJA;;;;;AAMO,MAAM,UAAU;AAER,SAAS;IACtB,MAAM,SAAS,IAAA,+IAAS;IAExB,IAAA,kNAAS,EAAC;QACR,eAAe;YACb,MAAM,WAAW,IAAA,yIAAY;YAE7B,IAAI;gBACF,MAAM,EACJ,MAAM,EAAE,MAAM,QAAQ,EAAE,EACxB,OAAO,SAAS,EACjB,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;gBAE/B,IAAI,aAAa,CAAC,UAAU;oBAC1B,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,IAAI,UAA+D;gBACnE,MAAM,oBAAoB,MAAM,SAC7B,IAAI,CAAC,YACL,MAAM,CAAC,mBACP,EAAE,CAAC,MAAM,SAAS,EAAE,EACpB,MAAM;gBAET,IAAI,kBAAkB,KAAK,IAAI,kBAAkB,KAAK,CAAC,OAAO,EAAE,cAAc,SAAS,cAAc;oBACnG,MAAM,uBAAuB,MAAM,SAChC,IAAI,CAAC,YACL,MAAM,CAAC,QACP,EAAE,CAAC,MAAM,SAAS,EAAE,EACpB,MAAM;oBAET,UAAU,qBAAqB,IAAI,GAAG;wBAAE,GAAG,qBAAqB,IAAI;wBAAE,WAAW;oBAAK,IAAI;gBAC5F,OAAO;oBACL,UAAU,kBAAkB,IAAI;gBAClC;gBAEA,MAAM,aAAa,IAAI,IAAI;oBAAC;oBAAc;oBAAkB;oBAAgB;oBAAW;iBAAU;gBACjG,IAAI,CAAC,SAAS,QAAQ,CAAC,WAAW,GAAG,CAAC,QAAQ,IAAI,GAAG;oBACnD,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,IAAI,SAAS,SAAS,cAAc;oBAClC,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,MAAM,CAAC,EAAE,MAAM,aAAa,EAAE,EAAE,EAAE,MAAM,WAAW,EAAE,CAAC,GAAG,MAAM,QAAQ,GAAG,CAAC;oBACzE,SAAS,IAAI,CAAC,mBAAmB,MAAM,CAAC,MAAM,EAAE,CAAC,YAAY,SAAS,EAAE,EAAE,WAAW;oBACrF,SAAS,IAAI,CAAC,iBAAiB,MAAM,CAAC,MAAM,EAAE,CAAC,YAAY,SAAS,EAAE,EAAE,WAAW;iBACpF;gBAED,IAAI,SAAS,SAAS,oBAAoB,eAAe;oBACvD,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,IAAI,SAAS,SAAS,kBAAkB,aAAa;oBACnD,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,IAAI,SAAS,SAAS,WAAW;oBAC/B,IAAI,CAAC,QAAQ,SAAS,EAAE;wBACtB,OAAO,IAAI,CAAC;wBACZ;oBACF;oBACA,OAAO,IAAI,CAAC;oBACZ;gBACF;gBAEA,OAAO,IAAI,CAAC;YACd,EAAE,OAAO,KAAU;gBACjB,QAAQ,KAAK,CAAC,6BAA6B;gBAC3C,OAAO,IAAI,CAAC;YACd;QACF;QAEA;IACF,GAAG;QAAC;KAAO;IAEX,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;;;;;8BACf,8OAAC;oBAAE,WAAU;8BAA4B;;;;;;;;;;;;;;;;;AAIjD"}}]
}