{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/emers/Documents/Averon%20Systems/ACL/lib/supabase/server.ts"],"sourcesContent":["import { createServerClient } from '@supabase/ssr'\nimport { cookies } from 'next/headers'\n\n/**\n * Especially important if using Fluid compute: Don't put this client in a\n * global variable. Always create a new client within each function when using\n * it.\n */\nexport async function createClient() {\n  const cookieStore = await cookies()\n\n  const supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL\n  const supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY\n\n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error('Supabase is not configured. Please add NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY environment variables.')\n  }\n\n  return createServerClient(\n    supabaseUrl,\n    supabaseKey,\n    {\n      cookies: {\n        getAll() {\n          return cookieStore.getAll()\n        },\n        setAll(cookiesToSet) {\n          try {\n            cookiesToSet.forEach(({ name, value, options }) =>\n              cookieStore.set(name, value, options),\n            )\n          } catch {\n            // The \"setAll\" method was called from a Server Component.\n            // This can be ignored if you have proxy refreshing\n            // user sessions.\n          }\n        },\n      },\n    },\n  )\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;;;AAOO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,MAAM;IACN,MAAM;IAEN;;IAIA,OAAO,IAAA,iMAAkB,EACvB,aACA,aACA;QACE,SAAS;YACP;gBACE,OAAO,YAAY,MAAM;YAC3B;YACA,QAAO,YAAY;gBACjB,IAAI;oBACF,aAAa,OAAO,CAAC,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,OAAO,EAAE,GAC5C,YAAY,GAAG,CAAC,MAAM,OAAO;gBAEjC,EAAE,OAAM;gBACN,0DAA0D;gBAC1D,mDAAmD;gBACnD,iBAAiB;gBACnB;YACF;QACF;IACF;AAEJ"}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/emers/Documents/Averon%20Systems/ACL/app/auth/callback/route.ts"],"sourcesContent":["import { createClient } from '@/lib/supabase/server'\nimport { NextResponse } from 'next/server'\n\nexport async function GET(request: Request) {\n  const requestUrl = new URL(request.url)\n  const code = requestUrl.searchParams.get('code')\n  const origin = requestUrl.origin\n\n  if (code) {\n    const supabase = await createClient()\n    const { error } = await supabase.auth.exchangeCodeForSession(code)\n\n    if (error) {\n      console.error('[v0] OAuth callback error:', error)\n      return NextResponse.redirect(`${origin}/auth/login?error=OAuth authentication failed`)\n    }\n\n    // Get user to check if profile exists\n    const {\n      data: { user },\n    } = await supabase.auth.getUser()\n\n    if (user) {\n      // Check if profile exists\n      const { data: profile } = await supabase.from('profiles').select('id').eq('id', user.id).single()\n\n      // If no profile, create one with default role\n      if (!profile) {\n        await supabase.from('profiles').insert({\n          id: user.id,\n          email: user.email,\n          full_name: user.user_metadata?.full_name || user.user_metadata?.name || user.email?.split('@')[0],\n          role: 'student', // Default to student for OAuth users\n          is_active: true,\n        })\n      }\n    }\n  }\n\n  // Redirect to protected route\n  return NextResponse.redirect(`${origin}/protected`)\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,IAAI,OAAgB;IACxC,MAAM,aAAa,IAAI,IAAI,QAAQ,GAAG;IACtC,MAAM,OAAO,WAAW,YAAY,CAAC,GAAG,CAAC;IACzC,MAAM,SAAS,WAAW,MAAM;IAEhC,IAAI,MAAM;QACR,MAAM,WAAW,MAAM,IAAA,2IAAY;QACnC,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,sBAAsB,CAAC;QAE7D,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,OAAO,gJAAY,CAAC,QAAQ,CAAC,GAAG,OAAO,6CAA6C,CAAC;QACvF;QAEA,sCAAsC;QACtC,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE/B,IAAI,MAAM;YACR,0BAA0B;YAC1B,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,YAAY,MAAM,CAAC,MAAM,EAAE,CAAC,MAAM,KAAK,EAAE,EAAE,MAAM;YAE/F,8CAA8C;YAC9C,IAAI,CAAC,SAAS;gBACZ,MAAM,SAAS,IAAI,CAAC,YAAY,MAAM,CAAC;oBACrC,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,WAAW,KAAK,aAAa,EAAE,aAAa,KAAK,aAAa,EAAE,QAAQ,KAAK,KAAK,EAAE,MAAM,IAAI,CAAC,EAAE;oBACjG,MAAM;oBACN,WAAW;gBACb;YACF;QACF;IACF;IAEA,8BAA8B;IAC9B,OAAO,gJAAY,CAAC,QAAQ,CAAC,GAAG,OAAO,UAAU,CAAC;AACpD"}}]
}